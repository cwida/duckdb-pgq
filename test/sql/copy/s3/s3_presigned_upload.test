# name: test/sql/copy/s3/s3_presigned_upload.test
# description: This test upload the data for later presigend url test  
# group: [s3]

require parquet

require httpfs

# Require that these environment variables are also set

require-env AWS_DEFAULT_REGION

require-env AWS_ACCESS_KEY_ID

require-env AWS_SECRET_ACCESS_KEY

require-env DUCKDB_S3_ENDPOINT

require-env DUCKDB_S3_USE_SSL

# override the default behaviour of skipping HTTP errors and connection failures: this test fails on connection issues
set ignore_error_messages

# small file 
statement ok
COPY "test/sql/copy/csv/data/real/web_page.csv" TO 's3://test-bucket/presigned/web_page.csv';

statement ok
COPY "test/sql/copy/csv/data/real/web_page.csv" TO 's3://test-bucket/presigned/web_page.parquet' (FORMAT 'parquet');