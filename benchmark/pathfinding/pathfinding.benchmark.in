# name: ${FILE_PATH}
# description: ${DESCRIPTION}
# group: [pathfinding]

name ${QUERY_NAME}
group pathfinding

require duckpgq

load
attach 'benchmark/pathfinding/data/snb-bi-sf${SCALE_FACTOR}.duckdb';
use 'snb-bi-sf${SCALE_FACTOR}';
set experimental_path_finding_operator=true;
create or replace table snb_pairs as (
   select src, dst
   from (select a.rowid as src from person a),
        (select b.rowid as dst from person b)
   using sample reservoir(${NUMBER_OF_SOURCES} rows) repeatable (300)
);
set threads=${THREADS};
set experimental_path_finding_operator_heavy_partition_fraction = ${HEAVY_FRACTION};
set experimental_path_finding_operator_light_partition_multiplier = ${LIGHT_MULTIPLIER};

run benchmark/pathfinding/queries/${QUERY_NAME}.sql
